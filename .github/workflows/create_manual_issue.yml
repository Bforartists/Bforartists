name: Create Manual Issue in Documentation Repo

on:
  push:
    branches:
      - main # Branch to monitor for changes
    types: [released] # Only trigger when a tag is pushed (after successful merge)

jobs:
  create_issue:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
        with:
          repository: Bforartists # Your documentation repository
          token: ${{ secrets.ACCESS_TOKEN }}
          fetch-depth: 0 # Fetch the entire commit history

      # Get the ID of the last commit
      - name: Get last commit id
        id: latest_commit
        run: echo "COMMIT_ID=$(git rev-parse HEAD)" >> $GITHUB_OUTPUT

      # Create an issue in the documentation repository
      - name: Create issue in documentation repo
        uses: actions/github-script@v6
        with:
          github-token: ${{ secrets.ACCESS_TOKEN }}
          script: |
            const title = 'Fix for commit ${COMMIT_ID} - Update Documentation'
            const body = `This issue was automatically created to update the documentation for commit \`${COMMIT_ID}\`.

          #generate the issue
            github.rest.issues.create({
              repo: 'Bforartists', # Your documentation repository
              title: title,
              body: body
            })
